apply plugin: 'java'

project.ext.tags = ['violation', 'static code analysis', 'Checkstyle', 'CPPLint', 'CPPCheck', 'CSSLint', 'Findbugs', 'Flake8', 'PyLint', 'Pep8', 'Mccabe', 'PyFlakes', 'JSHint', 'Lint', 'PerlCritic', 'PMD', 'ReSharper', 'XMLLint']
group = 'se.bjurr.violations'
description = 'Report static code analysis to Bitbucket Cloud.'
project.ext.useShadowJar = true
project.ext.syncCentral = false

jar {
  manifest {
    attributes 'Main-Class': 'se.bjurr.violations.main.Main'
  }
}

buildscript {
 repositories {
  maven { url "https://jitpack.io" }
 }
 dependencies {
  classpath 'com.github.tomasbjerre:gradle-scripts:master-SNAPSHOT'
 }
}
apply from: project.buildscript.classLoader.getResource('java.gradle').toURI()
apply from: project.buildscript.classLoader.getResource('changelog.gradle').toURI()
apply from: project.buildscript.classLoader.getResource('release.gradle').toURI()
apply from: project.buildscript.classLoader.getResource('violations.gradle').toURI()


dependencies {
 compile 'se.bjurr.violations:violation-comments-to-bitbucket-cloud-lib:1.15'
 compile 'se.bjurr.violations:violations-lib:1.132'
 compile 'se.softhouse:jargo:0.1.1'
 compile 'org.slf4j:slf4j-simple:1.8.0-beta2'
}

task copyDependencies(type: Copy) {
 from configurations.default
 into 'build/libs'
}

shadowJar {
 mergeServiceFiles() {
  exclude 'META-INF/services/*'
 }

 relocate 'org', 'org'
 relocate 'javax', 'javax'
 relocate 'com', 'com'
 relocate 'se', 'se'
 relocate 'io', 'io'
}
